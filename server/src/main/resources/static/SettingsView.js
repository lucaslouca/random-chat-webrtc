import{d as D,a as n,D as J,A as w,c as o,e as r,u as e,k as b,j as i,f as s,n as q,t as O,w as U,v as V,p as x,q as K,s as L,_ as Q}from"./index.js";import{S as G}from"./SpinnerComp.js";import{u as W}from"./user.js";const u=S=>(K("data-v-930ec36f"),S=S(),L(),S),X={class:"settings-component-content"},Z={key:1,class:"settings"},$=u(()=>s("h2",null,"Picture",-1)),ee={key:1,class:"field-label-container"},se=u(()=>s("label",{for:"username",class:"required"}," Picture ",-1)),le={class:"profile-picture-wrapper"},ae=["src"],te=u(()=>s("div",{class:"clearfix"},null,-1)),ne=u(()=>s("h2",null,"Profile",-1)),oe={class:"field-label-container"},ie=u(()=>s("label",{for:"username"}," Username ",-1)),ue={id:"username",class:"user"},re={key:1,class:"field-label-container"},ce=u(()=>s("label",{for:"email",class:"required"}," E-Mail ",-1)),de=["disabled"],fe=u(()=>s("div",{class:"clearfix"},null,-1)),ge=u(()=>s("h2",null,"Change password",-1)),pe={key:1,class:"field-label-container"},ve=u(()=>s("label",{for:"old-password",class:"required"}," Old password ",-1)),me={key:2,class:"field-label-container"},_e=u(()=>s("label",{for:"new-password",class:"required"}," New password ",-1)),he={key:3,class:"field-label-container"},we=u(()=>s("label",{for:"new-password-confirm",class:"required"}," Confirm new password ",-1)),Pe=["disabled"],Se=u(()=>s("div",{class:"clearfix"},null,-1)),Ee=D({__name:"SettingsComp",setup(S){let E=n(!1),c=n(null),p=n(!1),k=n(!1),C=n(null),I=n(null),v=n(null),P=n(!1),T=n(!1),m=n(null),_=n(null),d=n(null),f=n(null),g=n(!1),y=n(!1),h=n(null);j(),M(),B();const N=J(()=>c.value?"data:image/jpeg;base64,"+c.value:W);function B(){w.getEndpoints("users").get("getUsername")({}).then(function(a){console.log("[Members] Get username response",a),I.value=a.data})}function j(){E.value=!0,w.getEndpoints("users").get("getEmail")({}).then(function(a){console.log("[Settings] Get email response",a),v.value=a.data,E.value=!1})}function M(){p.value=!0,w.getEndpoints("users").get("getPicture")({}).then(function(a){console.log("[Settings] Get picture response",a),a.data?w.getEndpoints("users").get("getPictureResource")({fileName:a.data}).then(function(l){console.log("[Settings] Get picture resource response",l),c.value=l.data,p.value=!1}):(c.value=null,p.value=!1)})}function A(){y.value=!1,h.value=null,g.value=!1,_.value&&d.value&&f.value?d.value===f.value?F({oldPassword:_.value,newPassword:d.value,newPasswordConfirm:f.value}):(y.value=!0,h.value="New password entry does not match with confirmation entry!"):(y.value=!0,h.value="Please fill out all the fields!")}function R(a){c.value=a.target.files[0],k.value=!1,C.value=null,p.value=!1;const l=new FormData;l.append("file",c.value),c.value?H(l):(k.value=!0,C.value="Please provide an picture!")}function z(){T.value=!1,m.value=null,P.value=!1,v.value?Y({email:v.value}):(T.value=!0,m.value="Please provide an e-mail!")}function F(a){g.value=!0,console.log("[Settings] POST change password ",a),w.getEndpoints("users").get("changePassword")(a).then(function(l){console.log("[Settings] POST Change Password response",l);var t=l.data;h.value=t.message,t.success?(_.value=null,d.value=null,f.value=null,setTimeout(function(){h.value=null},2e3)):y.value=!0,g.value=!1})}function Y(a){P.value=!0,console.log("[Settings] POST change Email ",a),w.getEndpoints("users").get("changeEmail")(a).then(function(l){console.log("[Settings] POST Change Email response",l);var t=l.data;m.value=t.message,t.success?setTimeout(function(){m.value=null},2e3):T.value=!0,P.value=!1})}function H(a){p.value=!0,console.log("[Settings] POST change Picture ",a),w.getEndpoints("users").get("changePicture")(a).then(function(l){console.log("[Settings] POST Change Picture response",l);var t=l.data;C.value=t.message,t.success?(M(),setTimeout(function(){C.value=null},2e3)):k.value=!0})}return(a,l)=>(o(),r("div",X,[e(E)?(o(),b(G,{key:0,color:"red"})):i("",!0),e(E)?i("",!0):(o(),r("div",Z,[s("section",null,[$,e(p)?(o(),b(G,{key:0,color:"red"})):i("",!0),e(p)?i("",!0):(o(),r("div",ee,[se,s("div",le,[s("img",{src:N.value},null,8,ae)]),s("input",{type:"file",onChange:R,name:"image",id:"image",accept:"image/*"},null,32)])),e(C)?(o(),r("span",{key:2,id:"validation-message",class:q({success:e(k)===!1})},O(e(m)),3)):i("",!0),te]),s("section",null,[ne,s("div",oe,[ie,s("span",ue,O(e(I)),1)]),e(P)?(o(),b(G,{key:0,color:"red"})):i("",!0),e(P)?i("",!0):(o(),r("div",re,[ce,U(s("input",{id:"email",class:"input-field","onUpdate:modelValue":l[0]||(l[0]=t=>x(v)?v.value=t:v=t),placeholder:"Your E-mail"},null,512),[[V,e(v)]])])),e(m)?(o(),r("span",{key:2,id:"validation-message",class:q({success:e(T)===!1})},O(e(m)),3)):i("",!0),s("button",{class:"button",onClick:z,disabled:e(P)}," Update profile ",8,de),fe]),s("section",null,[ge,e(g)?(o(),b(G,{key:0,color:"red"})):i("",!0),e(g)?i("",!0):(o(),r("div",pe,[ve,U(s("input",{id:"old-password",type:"password",class:"input-field","onUpdate:modelValue":l[1]||(l[1]=t=>x(_)?_.value=t:_=t)},null,512),[[V,e(_)]])])),e(g)?i("",!0):(o(),r("div",me,[_e,U(s("input",{id:"new-password",type:"password",class:"input-field","onUpdate:modelValue":l[2]||(l[2]=t=>x(d)?d.value=t:d=t)},null,512),[[V,e(d)]])])),e(g)?i("",!0):(o(),r("div",he,[we,U(s("input",{id:"new-password-confirm",type:"password",class:"input-field","onUpdate:modelValue":l[3]||(l[3]=t=>x(f)?f.value=t:f=t)},null,512),[[V,e(f)]])])),e(h)?(o(),r("span",{key:4,id:"validation-message",class:q({success:e(y)===!1})},O(e(h)),3)):i("",!0),s("button",{class:"button",onClick:A,disabled:e(g),style:{clear:"right"}}," Update password ",8,Pe),Se])]))]))}});const Ce=Q(Ee,[["__scopeId","data-v-930ec36f"]]),Te=D({__name:"SettingsView",setup(S){return(E,c)=>(o(),b(Ce))}});export{Te as default};
