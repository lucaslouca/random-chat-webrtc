import{d as S,C as B,y as O,a as l,c as i,e as v,f as s,n as C,u as o,w as R,v as V,p as q,t as k,j as f,k as b,q as A,s as E,A as y,_ as L}from"./index.js";import{S as N}from"./SpinnerComp.js";const g=d=>(A("data-v-984f670b"),d=d(),E(),d),D={id:"login-component-container"},M={id:"center-cell"},j={key:0},z=g(()=>s("h1",null,"Change Password",-1)),J={class:"button-container"},F=g(()=>s("span",null,"Change",-1)),G=[F],H={id:"validation-message"},K=g(()=>s("div",{class:"clearfix"},null,-1)),Q=S({__name:"UpdatePasswordComp",emits:["authenticated"],setup(d,{emit:m}){const p=B(),I=O();let h=l(void 0),r=l(void 0),w=l(void 0),a=l(!1),_=l(null),c=l(null),u=l(!1);h.value=p.query.id,w.value=p.query.token;function U(t){a.value=!0,console.log("[UpdatePassword] POST change password ",t),_.value="Changing Password...",y.getEndpoints("users").get("changeLostPassword")(t).then(function(n){console.log("[UpdatePassword] POST Change Lost Password response",n);var e=n.data;e.success?x(e.username,t.password):(a.value=!1,u.value=!0,setTimeout(function(){u.value=!1},500),c.value=e.message)})}function x(t,n){a.value=!0,_.value="Logging In...",y.login(t,n).then(function(e){console.log("[UpdatePassword] Response: ",e),localStorage.setItem("user",JSON.stringify(e.data)),console.log("[UpdatePassword] Stored:",localStorage.getItem("user")),m("authenticated",!0),I.replace({path:"members/dashboard"})}).catch(function(e){var P=e.response;console.log("[UpdatePassword] Error: ",P),a.value=!1,e.value=!0,setTimeout(function(){e.value=!1},500),c.value=P.data.error_description})}function T(){if(r.value){var t={userId:h.value,password:r.value,token:w.value};U(t)}else u.value=!0,setTimeout(function(){u.value=!1},500),c.value="A password must be present"}return(t,n)=>(i(),v("div",D,[s("div",M,[s("div",{id:"login",class:C({shake:o(u)===!0})},[o(a)?f("",!0):(i(),v("div",j,[z,R(s("input",{type:"password",name:"password",class:"input-field","onUpdate:modelValue":n[0]||(n[0]=e=>q(r)?r.value=e:r=e),placeholder:"Password"},null,512),[[V,o(r)]]),s("div",J,[s("button",{type:"button",class:"button primary",onClick:T},G),s("span",H,k(o(c)),1)]),K])),o(a)?(i(),b(N,{key:1})):f("",!0),o(a)?(i(),v("h1",{key:2,class:C({loading:o(a)===!0})},k(o(_)),3)):f("",!0)],2)])]))}});const W=L(Q,[["__scopeId","data-v-984f670b"]]),Z=S({__name:"UpdatePasswordView",setup(d){return(m,p)=>(i(),b(W))}});export{Z as default};
